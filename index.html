            // --- [ê°œì„ ë¨] ë¡œê·¸ ì „ì²´ ë¶ˆëŸ¬ì˜¤ê¸° (ì‹œê°„, ëˆ„ê°€, ë¬´ì—‡ìœ¼ë¡œ, í–‰ë™) ---
            function loadAllLogs(userId) {
                const doorLockLogContainer = document.querySelector('#doorLockLogs .log-entries');
                const appLogContainer = document.querySelector('#appLogs .log-entries');
                const logUserTitle = document.getElementById('logUserTitle');
                
                logUserTitle.textContent = `${userId} ì „ì²´ ë¡œê·¸`;
                doorLockLogContainer.innerHTML = '<div class="message-box" style="padding:10px;">ë¡œë”© ì¤‘...</div>';
                appLogContainer.innerHTML = '<div class="message-box" style="padding:10px;">ë¡œë”© ì¤‘...</div>';

                // 1. ë„ì–´ë½ ID ì°¾ê¸°
                database.ref('users/' + userId).once('value').then((userSnap) => {
                    const user = userSnap.val();
                    let doorlockId = null;

                    if (user && user.my_doorlocks) {
                        doorlockId = Object.keys(user.my_doorlocks)[0];
                    }

                    // 2. App Logs ê°€ì ¸ì˜¤ê¸° (ê°œì„ ë¨)
                    const appLogsRef = database.ref(`users/${userId}/app_logs`);
                    appLogsRef.once('value').then(snapshot => {
                        if (!snapshot.exists() || snapshot.numChildren() === 0) {
                            appLogContainer.innerHTML = '<div class="message-box" style="padding:20px; text-align:center; color:#999;">ğŸ“± ì•± ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                        } else {
                            appLogContainer.innerHTML = '';
                            const logs = [];
                            snapshot.forEach(child => {
                                const logData = child.val();
                                if (logData) logs.push(logData);
                            });
                            
                            // ì‹œê°„ìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
                            logs.sort((a, b) => {
                                const timeA = a.timestamp ? new Date(a.timestamp).getTime() : 0;
                                const timeB = b.timestamp ? new Date(b.timestamp).getTime() : 0;
                                return timeB - timeA;
                            });
                            
                            logs.forEach(log => {
                                const entry = document.createElement('div');
                                entry.className = 'full-log-entry';
                                entry.style.padding = '12px 15px';
                                entry.style.marginBottom = '8px';
                                entry.style.backgroundColor = '#f8f9fa';
                                entry.style.borderRadius = '6px';
                                entry.style.borderLeft = '3px solid #6c757d';
                                
                                let timeStr = formatTimestamp(log.timestamp);
                                
                                // ì´ë²¤íŠ¸ íƒ€ì…ë³„ ë©”ì‹œì§€ êµ¬ì„±
                                let actionMsg = '';
                                let actionIcon = 'ğŸ“±';
                                
                                if (log.event) {
                                    const evt = log.event.toLowerCase();
                                    if (evt.includes('password') || evt.includes('ë¹„ë°€ë²ˆí˜¸')) {
                                        actionIcon = 'ğŸ”‘';
                                        actionMsg = 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í–ˆìŠµë‹ˆë‹¤';
                                    } else if (evt.includes('card') || evt.includes('ì¹´ë“œ')) {
                                        actionIcon = 'ğŸ’³';
                                        actionMsg = 'ì¹´ë“œí‚¤ë¥¼ ë“±ë¡/ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤';
                                    } else if (evt.includes('user') || evt.includes('ì‚¬ìš©ì')) {
                                        actionIcon = 'ğŸ‘¤';
                                        actionMsg = 'ì‚¬ìš©ì ì •ë³´ë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤';
                                    } else if (evt.includes('location') || evt.includes('ìœ„ì¹˜')) {
                                        actionIcon = 'ğŸ“';
                                        actionMsg = 'ìœ„ì¹˜ ì •ë³´ë¥¼ ì—…ë°ì´íŠ¸í–ˆìŠµë‹ˆë‹¤';
                                    } else if (evt.includes('setting') || evt.includes('ì„¤ì •')) {
                                        actionIcon = 'âš™ï¸';
                                        actionMsg = 'ì„¤ì •ì„ ë³€ê²½í–ˆìŠµë‹ˆë‹¤';
                                    } else {
                                        actionMsg = log.event;
                                    }
                                } else if (log.message) {
                                    actionMsg = log.message;
                                } else if (log.action) {
                                    actionMsg = log.action;
                                } else {
                                    // ë¡œê·¸ ê°ì²´ë¥¼ ë¶„ì„í•˜ì—¬ ë³€ê²½ì‚¬í•­ ì¶”ì¸¡
                                    const logKeys = Object.keys(log).filter(k => k !== 'timestamp' && k !== 'userId');
                                    if (logKeys.length > 0) {
                                        actionMsg = `${logKeys.join(', ')} ì •ë³´ë¥¼ ë³€ê²½í–ˆìŠµë‹ˆë‹¤`;
                                    } else {
                                        actionMsg = 'ì•±ì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í–ˆìŠµë‹ˆë‹¤';
                                    }
                                }
                                
                                entry.innerHTML = `
                                    <div style="display: flex; align-items: center; gap: 10px;">
                                        <span style="font-size: 1.5em;">${actionIcon}</span>
                                        <div style="flex: 1;">
                                            <div style="color:#666; font-size:0.85em; margin-bottom: 4px;">${timeStr}</div>
                                            <div style="font-size: 0.95em; color: #333;">
                                                <strong>${userId}</strong>ë‹˜ì´ ${actionMsg}
                                            </div>
                                        </div>
                                    </div>
                                `;
                                appLogContainer.appendChild(entry);
                            });
                        }
                    }).catch(err => {
                        console.error("ì•± ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨:", err);
                        appLogContainer.innerHTML = '<div class="message-box" style="color: red; padding:20px;">ì•± ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨</div>';
                    });

                    // 3. Doorlock Logs ê°€ì ¸ì˜¤ê¸° (ê°œì„ ë¨)
                    if (doorlockId) {
                        const dlLogsRef = database.ref(`doorlocks/${doorlockId}/logs`);
                        dlLogsRef.once('value').then(snapshot => {
                            if (!snapshot.exists() || snapshot.numChildren() === 0) {
                                doorLockLogContainer.innerHTML = '<div class="message-box" style="padding:20px; text-align:center; color:#999;">ğŸšª ë„ì–´ë½ ë¡œê·¸ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                            } else {
                                doorLockLogContainer.innerHTML = '';
                                const logs = [];
                                snapshot.forEach(child => {
                                    const logData = child.val();
                                    if (logData) logs.push(logData);
                                });
                                
                                // ì‹œê°„ìˆœ ì •ë ¬ (ìµœì‹ ìˆœ)
                                logs.sort((a, b) => {
                                    const timeA = a.timestamp ? new Date(a.timestamp).getTime() : 0;
                                    const timeB = b.timestamp ? new Date(b.timestamp).getTime() : 0;
                                    return timeB - timeA;
                                });

                                logs.forEach(log => {
                                    const entry = document.createElement('div');
                                    entry.className = 'full-log-entry';
                                    entry.style.padding = '12px 15px';
                                    entry.style.marginBottom = '8px';
                                    entry.style.borderRadius = '6px';
                                    
                                    // 1) ì‹œê°„
                                    let timeStr = formatTimestamp(log.timestamp);
                                    
                                    // 2) ëˆ„ê°€
                                    let who = log.user || log.userId || log.username || "ì•Œ ìˆ˜ ì—†ìŒ";

                                    // 3) ë¬´ì—‡ìœ¼ë¡œ (í•œê¸€ ë³€í™˜ + ì•„ì´ì½˜)
                                    let method = (log.method || log.type || "").toUpperCase();
                                    let methodDisplay = method;
                                    let methodIcon = 'ğŸ”“';
                                    
                                    if (method === "PASSWORD" || method === "PW") {
                                        methodDisplay = "ë¹„ë°€ë²ˆí˜¸";
                                        methodIcon = 'ğŸ”¢';
                                    } else if (method === "RF" || method === "CARD" || method === "RFID") {
                                        methodDisplay = "ì¹´ë“œí‚¤";
                                        methodIcon = 'ğŸ’³';
                                    } else if (method === "BLE" || method === "APP" || method === "BLUETOOTH") {
                                        methodDisplay = "ì•±(ë¸”ë£¨íˆ¬ìŠ¤)";
                                        methodIcon = 'ğŸ“±';
                                    } else if (method === "FINGER" || method === "FINGERPRINT") {
                                        methodDisplay = "ì§€ë¬¸";
                                        methodIcon = 'ğŸ‘†';
                                    } else if (method) {
                                        methodDisplay = method;
                                    } else {
                                        methodDisplay = "ì•Œ ìˆ˜ ì—†ìŒ";
                                    }

                                    // 4) í–‰ë™ (ê°œë°©/ì ê¸ˆ)
                                    let action = (log.command || log.status || log.action || "").toUpperCase();
                                    let actionDisplay = action;
                                    let actionStyle = "";
                                    let bgColor = "#f8f9fa";
                                    let borderColor = "#6c757d";

                                    if (action === "UNLOCK" || action === "OPEN" || action === "ê°œë°©") {
                                        actionDisplay = "ğŸ”“ ê°œë°©";
                                        actionStyle = "color: #007bff; font-weight: bold;";
                                        bgColor = "#e7f3ff";
                                        borderColor = "#007bff";
                                    } else if (action === "LOCK" || action === "CLOSE" || action === "ì ê¸ˆ") {
                                        actionDisplay = "ğŸ”’ ì ê¸ˆ";
                                        actionStyle = "color: #dc3545; font-weight: bold;";
                                        bgColor = "#ffe7e7";
                                        borderColor = "#dc3545";
                                    } else if (action) {
                                        actionDisplay = action;
                                    } else {
                                        actionDisplay = "ìƒíƒœ ë³€ê²½";
                                    }

                                    entry.style.backgroundColor = bgColor;
                                    entry.style.borderLeft = `4px solid ${borderColor}`;

                                    // ì¶œë ¥ í¬ë§·: ì•„ì´ì½˜ [ì‹œê°„] ëˆ„ê°€ - ë¬´ì—‡ìœ¼ë¡œ - í–‰ë™
                                    entry.innerHTML = `
                                        <div style="display: flex; align-items: center; gap: 10px;">
                                            <span style="font-size: 1.8em;">${methodIcon}</span>
                                            <div style="flex: 1;">
                                                <div style="color:#666; font-size:0.85em; margin-bottom: 4px;">${timeStr}</div>
                                                <div style="font-size: 0.95em;">
                                                    <strong style="color: #333;">${who}</strong>ë‹˜ì´ 
                                                    <span style="color: #666; font-weight: 500;">${methodDisplay}</span>(ìœ¼)ë¡œ 
                                                    <span style="${actionStyle}">${actionDisplay}</span>
                                                </div>
                                            </div>
                                        </div>
                                    `;
                                    doorLockLogContainer.appendChild(entry);
                                });
                            }
                        }).catch(err => {
                            console.error("ë„ì–´ë½ ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨:", err);
                            doorLockLogContainer.innerHTML = '<div class="message-box" style="color: red; padding:20px;">ë„ì–´ë½ ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨</div>';
                        });
                    } else {
                        doorLockLogContainer.innerHTML = '<div class="message-box" style="padding:20px; text-align:center; color:#ff9800;">âš ï¸ ì—°ê²°ëœ ë„ì–´ë½ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
                    }

                }).catch(err => {
                    console.error("ë¡œê·¸ ë¡œë“œ ì‹¤íŒ¨:", err);
                    doorLockLogContainer.innerHTML = '<div class="message-box" style="color: red; padding:20px;">ë¡œë“œ ì‹¤íŒ¨: ' + err.message + '</div>';
                    appLogContainer.innerHTML = '<div class="message-box" style="color: red; padding:20px;">ë¡œë“œ ì‹¤íŒ¨: ' + err.message + '</div>';
                });
            }
